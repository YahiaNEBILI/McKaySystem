# AWS S3 checker

Status: Canonical  
Last reviewed: 2026-02-15

**Source code:** `checks/aws/s3_storage.py`

## Purpose

Emit S3 governance and storage-cost signals at bucket scope.

## Checker identity

- `checker_id`: `aws.s3.storage`
- `spec`: `checks.aws.s3_storage:S3StorageChecker`
- `is_regional`: `False` (global checker run once per full scan)

## Check IDs emitted

- `aws.s3.governance.lifecycle.missing`
- `aws.s3.governance.encryption.missing`
- `aws.s3.governance.public.access.block.missing`
- `aws.s3.cost.bucket.storage.estimate`

## Key signals

- Buckets missing lifecycle configuration.
- Buckets missing default encryption.
- Buckets missing full public-access-block controls.
- Storage-size cost estimate signal per bucket.

## Configuration and defaults

Configured via checker constructor.
Defaults are sourced from `checks/aws/defaults.py`:
- `S3_DEFAULT_STORAGE_PRICE_GB_MONTH_USD`
- `S3_METRIC_LOOKBACK_DAYS`

## IAM permissions

Typical read-only permissions:
- `s3:ListAllMyBuckets`
- `s3:GetBucketLocation`
- `s3:GetLifecycleConfiguration`
- `s3:GetBucketEncryption`
- `s3:GetPublicAccessBlock`
- `cloudwatch:GetMetricData` (for storage estimate path where used)

Optional for improved cost-confidence:
- `pricing:GetProducts` (via pricing service)

## Determinism and limitations

- Bucket-level governance findings are deterministic for equivalent API responses.
- Storage estimates are directional and not a direct replacement for CUR.
- This checker intentionally emits multiple independent S3 signals for correlation/aggregation.

## Related tests

- `tests/test_s3_storage.py`
